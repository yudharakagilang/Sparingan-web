<!DOCTYPE html>
<html lang="en">

<head>
    <title>Main Menu </title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--===============================================================================================-->
    <link rel="icon" type="image/png" href="images/icons/favicon.ico" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="fonts/Linearicons-Free-v1.0.0/icon-font.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="css/util.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <!--===============================================================================================-->
</head>

<body>

    <div class="limiter">
        <div class="container-login100">
            <div class="wrap-login100">
                <div  class="login100-form-title" style="background-image: url(images/bg-01.png);">
                    <div id="div_nama"></div>
                         <script type="text/javascript">
                            var text = "Hello, "
                            document.getElementById('div_nama').innerHTML = text.concat(localStorage.getItem("name_login"), "!");
                        </script>
                </div>
                <div>
                    <br>
                    <font id="status" size="+4">&nbsp&nbsp&nbspBelum Mempunyai Jadwal </font>
                    <br>
                    <div id="div_sport"></div>
                         <script type="text/javascript">
                            var text = "&nbsp&nbsp&nbspSport : "
                            document.getElementById('div_sport').innerHTML = text.concat(localStorage.getItem("sport"));
                        </script>
                    <div id="div_date"></div>
                        <script type="text/javascript">
                            var text = "&nbsp&nbsp&nbspDate : "
                            document.getElementById('div_date').innerHTML = text.concat(localStorage.getItem("date"));
                        </script>
                    <div id="div_location"></div>
                        <script type="text/javascript">
                            var text = "&nbsp&nbsp&nbspLocation : "
                            document.getElementById('div_location').innerHTML = text.concat(localStorage.getItem("location"));
                        </script>
                </div>
                <p id="buttonCari" align="center">
                    <button onclick="window.location.href = 'carilawan.html';" id="button_carilawan" class="login100-form-btn" href="carilawan.html" style="margin-left:auto;margin-right:auto;display:block;margin-top:10%;margin-bottom:0%">
                        <span class="login100-form-title-1">
                            Cari Lawan!
                        </span>
                    </button>
                </p>
                <p id="buttonCancel" align="center">
                    <button onClick = "buttonfunction()" id="button_carilawan" class="login100-form-btn" href="carilawan.html" style="margin-left:auto;margin-right:auto;display:block;margin-top:10%;margin-bottom:0%">
                        <span class="login100-form-title-1">
                            Cancel Pertandingan!
                        </span>
                    </button>
                </p>
                <p id="buttonFinish" align="center">
                    <button onClick = "buttonfunction()" id="button_carilawan" class="login100-form-btn" href="carilawan.html" style="margin-left:auto;margin-right:auto;display:block;margin-top:10%;margin-bottom:0%">
                        <span class="login100-form-title-1">
                            Finish Pertandingan!
                        </span>
                    </button>
                </p>
                <button onclick="logout()" type="button" class="btn btn-danger" data-toggle="modal">
                    Logout
                </button>
                <br>
            </div>
        </div>
    </div>
    <!--===============================================================================================-->
    <script src="vendor/jquery/jquery-3.2.1.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/animsition/js/animsition.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/bootstrap/js/popper.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/select2/select2.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/daterangepicker/moment.min.js"></script>
    <script src="vendor/daterangepicker/daterangepicker.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/countdowntime/countdowntime.js"></script>
    <!--===============================================================================================-->
    <script src="js/main.js"></script>
     <script src="logout.js"></script>

</body>

</html>
<script>
$.get("http://localhost:8080/getuser/" + localStorage.getItem('id_login'), function( data ){
    localStorage.setItem('id_login', data.id);
    localStorage.setItem('name_login', data.name);
    localStorage.setItem('phoneNumber_login', data.phoneNumber);
    localStorage.setItem('email_login', data.email);
    localStorage.setItem('isScheduled',data.isScheduled);
    localStorage.setItem('scheduleID',data.scheduleID);                
}, "json" );

$.get("http://localhost:8080/schedule/" + localStorage.getItem('scheduleID'), function( data ){
    localStorage.setItem('sport', data.sport);
    localStorage.setItem('location', data.location);
    localStorage.setItem('date', data.date);
    localStorage.setItem('user1name', data.user1.name);
    localStorage.setItem('user2name', data.user2.name);
}, "json" );

if (localStorage.getItem('id_login')==null){
    window.location.replace("index.html");
}

if (localStorage.getItem('isScheduled')=='false'){
    if (localStorage.getItem('scheduleID')=='0'){
        $("#status").html("&nbsp&nbsp&nbspBelum Memiliki Jadwal!")
          document.getElementById("buttonCari").style.display = "block";
          document.getElementById("buttonCancel").style.display = "none";
          document.getElementById("buttonFinish").style.display = "none";
    }
    else{
        $("#status").html("&nbsp&nbsp&nbspMenunggu Jadwal!")
          document.getElementById("buttonCari").style.display = "none";
          document.getElementById("buttonCancel").style.display = "block";
          document.getElementById("buttonFinish").style.display = "none";
    }
}
else{
    $("#status").html("&nbsp&nbsp&nbspDalam Permainan!")
        document.getElementById("buttonCari").style.display = "none";
        document.getElementById("buttonCancel").style.display = "none";
        document.getElementById("buttonFinish").style.display = "block";
        document.getElementById("status_name","status_date","status_sport","status_lokasi").style.display = "block";
}

function buttonfunction () {
    let param = {
        scheduleid : localStorage.getItem('scheduleID'),
        userid : localStorage.getItem('id_login')
    }
    $.ajax({
        type: 'POST',
        url: 'http://localhost:8080/finishmatch',
        data: param,
        success: (data, status, jqXHR) => {
            alert("success")
        },
        error: (jqXHR, status, errorThrown) => {
            console.log(jqXHR)
            alert("failed")
        },
        dataType: 'json',
        timeout: 10000
    })
    return false;
}
</script>